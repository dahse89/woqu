// Generated by CoffeeScript 1.9.1
(function() {
  var Log;

  module.exports = Log = (function() {
    function Log(master, args) {
      this.master = master;
      this.args = args;
    }

    Log.prototype.init = function() {
      return this.logInfo();
    };


    /**
    * set current Task to done and print it
     */

    Log.prototype.logInfo = function() {
      var IO, LoggedWork, msg, ref, text, todo;
      ref = this.master.factory('cmd/todo', 'model/LoggedWork', 'IO', 'config/messages.noTaskOpen'), todo = ref[0], LoggedWork = ref[1], IO = ref[2], msg = ref[3];
      text = this.args[0];
      return todo.getCurrentTask(function(task) {
        var work;
        if (task === null) {
          IO.println(msg);
          return process.exit();
        } else {
          work = LoggedWork.build({
            text: text
          });
          return work.save()["catch"](IO.error).then(function() {
            return task.addLoggedWork(work).then(function() {
              return todo.init();
            });
          });
        }
      });
    };

    return Log;

  })();

  module.exports = Log;

}).call(this);
