// Generated by CoffeeScript 1.4.0
(function() {
  var Add;

  Add = (function() {
    var Task, args, db, master;
    Task = require('../model/Task.js');
    db = null;
    master = null;
    args = null;
    return {
      /**
      * init Add model, args are passed
      * to receive model options
      * @param _args array
      * @param _db Db_ref
      * @param _master WoQu_ref
      */

      init: function(_args, _master) {
        var IO, task, _ref;
        args = _args;
        master = _master;
        _ref = master.coreModels("db", "IO"), db = _ref[0], IO = _ref[1];
        if (args.length === 0) {
          IO.readLine("Description: ", function(answer) {
            return IO.println("Thank you for your valuable feedback:" + answer);
          });
          return;
        }
        if (args.length === 1) {
          task = new Task();
          task.setDescription(args[0]);
          task.setCreatedAt(new Date());
          task.setPostponed(0);
          return Add.addTask(task, function() {
            return process.exit();
          });
        }
      },
      /**
      * add a Task to database
      */

      addTask: function(task, cb) {
        return db.init(function(db) {
          return db.insertTask(task, function() {
            task.setId(this.lastID);
            console.log("Task #" + (task.getId()) + " added");
            return cb();
          });
        });
      }
    };
  })();

  module.exports = Add;

}).call(this);
