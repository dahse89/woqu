// Generated by CoffeeScript 1.4.0
(function() {
  var Add;

  module.exports = Add = (function() {

    function Add(master, args) {
      this.master = master;
      this.args = args;
    }

    Add.prototype.init = function() {
      var Task, task, _ref;
      _ref = this.master.coreModels("db", "IO"), this.db = _ref[0], this.IO = _ref[1];
      if (this.args.length === 0) {
        this.IO.readLine("Description: ", function(answer, IO) {
          return IO.println("Thank you for your valuable feedback:" + answer);
        });
        return;
      }
      if (this.args.length === 1) {
        Task = this.master.getTask();
        task = new Task();
        task.setDescription(this.args[0]);
        task.setCreatedAt(new Date());
        task.setPostponed(0);
        return this.addTask(task, function() {
          return process.exit();
        });
      }
    };

    /**
    * add a Task to database
    */


    Add.prototype.addTask = function(task, cb) {
      var IO, Task, db;
      IO = this.IO;
      Task = this.master.getTask();
      db = new this.db(this.master);
      return db.init(function(orm, models) {
        models.Task.find();
        return models.Task.create(task).then(function(res) {
          task.fromOrm(res);
          IO.println("Add Task: #" + (task.getId()));
          return cb();
        });
      });
    };

    return Add;

  })();

  module.exports = Add;

}).call(this);
