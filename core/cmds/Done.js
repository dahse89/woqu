// Generated by CoffeeScript 1.9.1
(function() {
  var Done;

  module.exports = Done = (function() {
    function Done(master, args) {
      var ref;
      this.master = master;
      this.args = args;
      ref = this.master.coreModels("IO", "db"), this.IO = ref[0], this.db = ref[1];
    }

    Done.prototype.init = function() {
      return this.setDone();
    };


    /**
    * set current Task to done and print it
     */

    Done.prototype.setDone = function() {
      var IO, todo;
      IO = this.IO;
      todo = this.master.factory('todo');
      return todo.getCurrentTask(function(task) {
        var attr, where;
        attr = {
          done_at: new Date()
        };
        where = {
          where: {
            id: task.getDataValue("id")
          }
        };
        return task.update(attr, where).then(function() {
          IO.printTask(task);
          return todo.init();
        })["catch"](function(err) {
          return console.log(err);
        });
      });
    };

    return Done;

  })();

  module.exports = Done;

}).call(this);
