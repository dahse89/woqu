// Generated by CoffeeScript 1.4.0
(function() {
  var Todo;

  module.exports = Todo = (function() {

    function Todo(master, args) {
      this.master = master;
      this.args = args;
    }

    Todo.prototype.init = function() {
      var _ref;
      _ref = this.master.coreModels("db", "IO"), this.db = _ref[0], this.IO = _ref[1];
      return this.getTodo();
    };

    /**
    * get current Task from database
    */


    Todo.prototype.getTodo = function() {
      var IO, Task, db;
      IO = this.IO;
      Task = this.master.getTask();
      db = new this.db(this.master);
      return db.init(function(orm, models) {
        return models.Task.find({
          where: ["done_at is not null"],
          order: [["(task_id+postponed)", "ASC"], ["postponed", "ASC"], ["task_id", "ASC"]],
          limit: 1
        }).then(function(res) {
          return console.log(res);
        });
      });
    };

    return Todo;

  })();

  module.exports = Todo;

  /*
        SELECT
        id,
        description,
        created_at,
        postponed,
        done_at
      FROM tasks
      WHERE done_at IS NULL
      ORDER by (id+postponed),postponed,id ASC
      LIMIT 1
  */


}).call(this);
