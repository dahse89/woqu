// Generated by CoffeeScript 1.9.1
(function() {
  var Todo;

  module.exports = Todo = (function() {
    function Todo(master, args) {
      this.master = master;
      this.args = args;
    }

    Todo.prototype.init = function() {
      return this.getTodo();
    };

    Todo.prototype.getCurrentTask = function(cb) {
      return this.master.factory('model/Task').find({
        where: ["done_at is null"],
        order: 'id + postponed, postponed, id ASC',
        limit: 1
      }).then(cb);
    };


    /**
    * get current Task from database
     */

    Todo.prototype.getTodo = function() {
      var IO, msg, ref;
      ref = this.master.factory('IO', 'config/messages.nothingTodo'), IO = ref[0], msg = ref[1];
      return this.getCurrentTask(function(task) {
        if (task === null) {
          IO.println(msg);
          return process.exit();
        } else {
          return IO.printTask(task, function() {
            return process.exit();
          });
        }
      });
    };

    return Todo;

  })();

}).call(this);
